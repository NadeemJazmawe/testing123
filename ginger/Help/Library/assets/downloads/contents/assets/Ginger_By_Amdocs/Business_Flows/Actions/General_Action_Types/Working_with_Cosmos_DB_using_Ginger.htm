<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="generator" content="Adobe RoboHelp 2020" />
  <title>Working with Cosmos DB using Ginger</title>
  <meta name="topic-status" content="Draft" />
  <link rel="stylesheet" type="text/css" href="../../../../css/default.css" />
  <link rel="stylesheet" type="text/css" href="../../../../css/GingerDocStyle.css" />
</head>
<body>
  <h1>Working with Cosmos DB</h1>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">Ginger supports integration with Azure Cosmos DB to connect and execute DB quries for validations and fetching the data require for Automation flows.</span></span></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"> </p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">Current supported functionalities are:</span></span></span></span></span></p>
  <ul>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:16px"><span style="font-size:11pt"><span style="line-height:normal"><span style="tab-stops:list .5in"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Symbol"></span></span><span style="font-size:12.0pt"><span style="color:black">Configure connection string and check Cosmos connectivity</span></span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:16px"><span style="font-size:11pt"><span style="line-height:normal"><span style="tab-stops:list .5in"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Symbol"></span></span><span style="font-size:12.0pt"><span style="color:black">Run select query on Cosmos Container</span></span><span style="font-size:10.5pt"><span style="color:black"></span></span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:16px"><span style="font-size:11pt"><span style="line-height:normal"><span style="tab-stops:list .5in"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Symbol"></span></span><span style="font-size:12.0pt"><span style="color:black">Run record count query on Cosmos Container</span></span><span style="font-size:10.5pt"><span style="color:black"></span></span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:16px"><span style="font-size:11pt"><span style="line-height:normal"><span style="tab-stops:list .5in"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Symbol"></span></span><span style="font-size:12.0pt"><span style="color:black">Update existing record in Container</span></span><span style="font-size:10.5pt"><span style="color:black"></span></span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:16px"><span style="font-size:11pt"><span style="line-height:normal"><span style="tab-stops:list .5in"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.0pt"><span style="font-family:Symbol"></span></span><span style="font-size:12.0pt"><span style="color:black">Insert new record into Container</span></span><span style="font-size:10.5pt"><span style="color:black"></span></span></span></span></span></span></li>
  </ul>
  <p style="margin-top:5px; margin-bottom:5px; margin-left:16px"> </p>
  <h2 style="margin-top: 5px; margin-bottom: 5px;"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="color:#ec008c">Prerequisites</span></span></b></span></span></span></h2>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="line-height:107%">Cosmos DB and Container structure should be set-up and Cosmos Db should be reachable over the Internet.</span></span></span></span></span></p>
  <h2 style="margin-bottom: 11px;"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="color:#ec008c">Configure Cosmos Db</span></span></b></span></span></span></h2>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">To Configure Cosmos Db in Ginger, go to Environments -&gt; Your Environment -&gt; Databases and Click on the ‘<b>+</b>’ Symbol. From the dropdown, select CosmosDb as shown below. To configure Connection String, click on the ‘…’ button in your Cosmos entry.</span></span></span></span></span></p>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="color:#ec008c"> <img src="../../../../images/image397.png" /></span></span></b><b><span style="font-size:18.0pt"><span style="color:#ec008c"></span></span></b></span></span></span></p>
  <ul class="Disc">
    <li style="margin-bottom: 11px;"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="line-height:107%"><span style="color:black">For Connection string, </span></span></span></span></span></span><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="line-height:107%">Please refer to below Screenshot. </span></span></li>
  </ul>
  <p style="margin-bottom: 11px;"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif">                <img src="../../../../images/image390.png" style="width: 624px; height: 106px;" /></span></span></span></p>
  <ul class="Disc">
    <li style="margin-bottom: 11px;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="line-height:107%">You can also copy-paste the connection string from your Azure portal and at the end, append the name of the Db that you want to point to. </span></span></li>
    <li style="margin-bottom: 11px;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="line-height:107%">If you have multiple DBs in your Cosmos instance, you will need multiple entries in the Environments Database table. </span></span></li>
    <li style="margin-bottom: 11px;"><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="line-height:107%">Click on the <i>Test Connection</i> (</span></span><img src="../../../../images/image389.png" style="font-family: Calibri, sans-serif; font-size: 11pt; width: 19px; height: 18px;" /><span style="font-family: Calibri, sans-serif; font-size: 12pt;"><span style="line-height:107%">) button to test connectivity.</span></span><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif">         <span style="font-size:12.0pt"><span style="line-height:107%"><span style="color:black"></span></span></span></span></span></span></li>
  </ul>
  <p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="color:#ec008c">Configuring Database Action for Cosmos</span></span></b></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"> </p>
  <p style="margin-top:5px; margin-bottom:5px">Database Action can be added from Action Library -&gt; General action</p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">For Cosmos Db, Ginger supports below operations:</span></span></span></span></span></p>
  <ol style="list-style-type:lower-alpha">
    <li style="margin-top:5px; margin-bottom:5px; margin-left:8px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"></span><span style="font-size:12.0pt"><span style="color:black">Free SQL</span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:8px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"></span><span style="font-size:12.0pt"><span style="color:black">Insert</span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:8px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"></span><span style="font-size:12.0pt"><span style="color:black">Record Count</span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:8px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"></span><span style="font-size:12.0pt"><span style="color:black">Simple SQL One Value</span></span></span></span></span></li>
    <li style="margin-top:5px; margin-bottom:5px; margin-left:8px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"></span><span style="font-size:12.0pt"><span style="color:black">Update DB</span></span></span></span></span></li>
  </ol>
  <p style="margin-top:5px; margin-bottom:5px; margin-left:8px"> </p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="color:black">              <img src="../../../../images/image391.png" style="width: 624px; height: 128px;" /></span></span><span style="font-size:10.5pt"><span style="color:black"></span></span></span></span></span></p>
  <p style="margin-bottom:11px"> </p>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="color:#ec008c">Free SQL Operation</span></span></b></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="color:black">The <i>Free SQL</i> operation lets you input any SQL query that you’d normally run on your Cosmos console. </span></span></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:10.5pt"><span style="color:black"><strong>Note :</strong> For SQL query to work properly, the Container name is case-sensitive. It must match with the exact name of the Container present in your Db, otherwise the API will not be able to identify the correct Container.</span></span></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"> </p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><img src="../../../../images/image392.png" style="width: 624px; height: 173px;" /></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"> </p>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="line-height:107%"><span style="color:#ec008c">Record Count Operation</span></span></span></b></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">Record count lets you simply enter the Container name and any where condition you wish to add, and returns the count of elements associated with that query</span></span></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"> </p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">           <img src="../../../../images/image393.png" style="width: 624px; height: 168px;" /></span></span></span></span></span></p>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="color:#ec008c">Insert</span></span></b><b><span style="font-size:12.0pt"><span style="color:black"></span></span></b></span></span></span></p>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="color:black">For Inserting data into Cosmos Container, you need to select the Container name in the dropdown provided, and provide the Primary Key (id in below screenshot) and Partition Key (LastName in below screenshot) values, along with the JSON that you wish to push to the Container. Please refer below screenshot.</span><b><span style="font-size:12.0pt"><span style="color:black"></span></span></b></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif">                 <b><span style="font-size:18.0pt"><span style="color:#ec008c"><img src="../../../../images/image416.png" /></span></span></b></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="color:#ec008c">Update DB</span></span></b></span></span></span></p>
  <ul class="Disc">
    <li style="margin-top: 5px; margin-bottom: 5px;"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">To update entry in Cosmos db, we will leverage the <i>Partial Update</i> or <i>Patch Operation</i> provided by Cosmos. </span></span></span></span></span></li>
    <li style="margin-top: 5px; margin-bottom: 5px;"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">For configuring this action, you need to select the Container name from the dropdown, provide Primary and Partition Key Values, </span></span></span></span></span></li>
    <li style="margin-top: 5px; margin-bottom: 5px;"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">Then enter the Paths and the updated values of the JSON Nodes which you wish to modify. </span></span></span></span></span></li>
    <li style="margin-top: 5px; margin-bottom: 5px;"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">For reference on how to provide Path to corresponding JSON Node, please check these links:</span></span></span></span></span></li>
  </ul>
  <p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><a href="https://docs.microsoft.com/en-us/azure/cosmos-db/partial-document-update" style="color:#0563c1; text-decoration:underline"><span style="font-size:12.0pt">https://docs.microsoft.com/en-us/azure/Cosmos-db/partial-document-update</span></a><span style="font-size:12.0pt"><span style="color:black"></span></span></span></span></span></p>
  <p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><a href="https://sajeetharan.com/2022/02/22/leveraging-partial-document-update-with-with-cosmos-db-rest-operation/" style="color:#0563c1; text-decoration:underline"><span style="font-size:12.0pt">https://sajeetharan.com/2022/02/22/leveraging-partial-document-update-with-with-Cosmos-db-rest-operation/</span></a><span style="font-size:12.0pt"><span style="color:black"></span></span></span></span></span></p>
  <p> </p>
  <p><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">Please note that we can add more than one JSON Node if we require, we have just shown one as an example.</span></span></span></span></span></p>
  <p> </p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif">              <img src="../../../../images/image395.png" style="width: 624px; height: 202px;" /><b><span style="font-size:18.0pt"><span style="color:#ec008c"></span></span></b></span></span></span></p>
  <p style="margin-bottom:11px"> </p>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"><b><span style="font-size:18.0pt"><span style="line-height:107%"><span style="color:#ec008c">Simple SQL One Value</span></span></span></b></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black">For Simple SQL One Value, you need to simply select the Container name from the dropdown and add any condition if required, as shown below, and Ginger will internally construct the query, execute it on Cosmos and show you the results.</span></span></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"> </p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><img src="../../../../images/image396.png" style="width: 624px; height: 148px;" /><span style="font-size:12.0pt"><span style="color:black"></span></span></span></span></span></p>
  <p style="margin-top:5px; margin-bottom:5px"><span style="font-size:11pt"><span style="line-height:normal"><span style="font-family:Calibri,sans-serif"><span style="font-size:12.0pt"><span style="color:black"></span></span></span></span></span></p>
  <p style="margin-bottom:11px"><span style="font-size:11pt"><span style="line-height:107%"><span style="font-family:Calibri,sans-serif"></span></span></span></p>
</body>
</html>